setwd(folder_path)}
#load data
data <- read.csv("hip.csv", sep=',')
#Display the names of variables in the data set.
names(data)
#Observe/explore the data
dim(data)
summary(data)
data$smoking[data$sex == "Female"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Female"),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$smoking[data$sex == "Male"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Male"),
replace=TRUE, prob = c(0.15, 0.75, 0.1))
data$smoking = factor(data$smoking)
View(data)
#transform/include labels to data
data = data %>%
mutate(sex = factor(sex, levels = c(0,1), labels = c("Male","Female")),
retired = factor(retired, levels = c(0,1), labels = c("Not retired","Retired")),
ethnic = factor(ethnic, levels = c(0,1), labels = c("White","Non white")),
side = factor(side, levels = c(0,1), labels = c("Right","Left")))
View(data)
#install.packages("dplyr")
library(dplyr)
#See your working directory
getwd()
#Update your working directory to the folder where "hip.data" is stored (if necessary)
update_wd = "NO" #"NO" for keeping the current working directory. "YES" to update, plus including the new path in folder_path variable below.
if(update_wd == "YES"){
folder_path <- ("C:/Users/msanchez/Documents/GitHub/Practical_Imputation/multiple-imputation_with_mice/")  #Remind to use / (NOT \)
setwd(folder_path)}
#load data
data <- read.csv("hip.csv", sep=',')
#Display the names of variables in the data set.
names(data)
data$smoking[data$sex == "Female"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Female"),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$smoking[data$sex == "Male"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Male"),
replace=TRUE, prob = c(0.15, 0.75, 0.1))
data$smoking = factor(data$smoking)
data$smoking[data$sex == "Female"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Female"),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$smoking[data$sex == "Male"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Male"),
replace=TRUE, prob = c(0.15, 0.75, 0.1))
data$smoking = factor(data$smoking)
View(data)
data$occupation[data$ohsdiff < 0] =
sample(c("Manual worker", "Non-manual worker", NA),
sum(data$ohsdiff < 0),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$occupation[data$ohsdiff >=0] =
sample(c("Manual worker", "Non-manual worker", NA),
sum(data$ohsdiff >=0),
replace=TRUE, prob = c(0.15, 0.75, 0.1))
data$occupation = factor(data$occupation)
View(data)
data$smoking[data$sex == "Female"] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == "Female"),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$smoking[data$sex == 1] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == 1),
replace = TRUE,
prob = c(0.1, 0.5, 0.4))
data$smoking[data$sex == 0] =
sample(c("Smoker", "Non-smoker", NA),
sum(data$sex == 0),
replace=TRUE, prob = c(0.15, 0.75, 0.1))
View(data)
data$smoking = factor(data$smoking)
data$occupation = factor(data$occupation)
View(data)
#transform/include labels to data
data = data %>%
mutate(sex = factor(sex, levels = c(0,1), labels = c("Male","Female")),
retired = factor(retired, levels = c(0,1), labels = c("Not retired","Retired")),
ethnic = factor(ethnic, levels = c(0,1), labels = c("White","Non white")),
side = factor(side, levels = c(0,1), labels = c("Right","Left")))
View(data)
#Observe/explore the data
dim(data)
summary(data)
na.test(data, digits = 2, p.digits = 3, as.na = NULL, check = TRUE, output = TRUE)
#Selecting variables with missing data
missvars <- c("imdscore", "eq5d0", "satisfaction", "ethnic", "height", "weight", "bmi", "retired", "smoking", "occupation")
missdata <- data[missvars]
na.test(missdata, digits = 2, p.digits = 3, as.na = NULL, check = TRUE, output = TRUE)
missvars <- c("smoking", "occupation")
missdata <- data[missvars]
na.test(missdata, digits = 2, p.digits = 3, as.na = NULL, check = TRUE, output = TRUE)
table(data$sex, data$smoking)
chisq.test(table(data$sex, data$smoking))
missvars <- c("age", "sex", "ohsdiff", "imdscore", "ethnic", "bmi", "retired", "smoking", "occupation")
missdata <- data[missvars]
na.test(missdata, digits = 2, p.digits = 3, as.na = NULL, check = TRUE, output = TRUE)
missvars <- c("age", "sex", "ohsdiff", "imdscore", "eq5d0", "ethnic", "bmi", "retired", "side" ,"smoking", "occupation")
missdata <- data[missvars]
na.test(missdata, digits = 2, p.digits = 3, as.na = NULL, check = TRUE, output = TRUE)
lm(ohsdiff ~ occupation, data = data)
summary(lm(ohsdiff ~ occupation, data = data))
summary(lm(ohsdiff ~ smoking, data = data))
summary(lm(ohsdiff ~ age + sex + smoking, data = data))
summary(lm(ohsdiff ~ age + sex + smoking + occupational, data = data))
summary(lm(ohsdiff ~ age + sex + smoking + occupation, data = data))
summary(glm(sex ~ age + smoking + occupation, data = data))
glm(sex ~ age + smoking + occupation, data = data)
glm(occpation ~ age + smoking , data = data)
glm(occupation ~ age + smoking , data = data)
glm(occupation ~ age)
glm(occupation ~ age, data=data)
View(data)
glm(sex ~ age, data=data)
data<-data %>% mutate(MyBinary = ifelse(ohsdiff>median(ohsdiff), 1 ,0))
table(data$MyBinary)
lm(ohsdiff~MyBinary, data=data)
summary(lm(ohsdiff~MyBinary, data=data))
rm(list=ls())
#install.packages("dplyr")
library(dplyr)
#See your working directory
getwd()
#Update your working directory to the folder where "hip.data" is stored (if necessary)
update_wd = "NO" #"NO" for keeping the current working directory. "YES" to update, plus including the new path in folder_path variable below.
if(update_wd == "YES"){
folder_path <- ("C:/Users/msanchez/Documents/GitHub/Practical_Imputation/multiple-imputation_with_mice/")  #Remind to use / (NOT \)
setwd(folder_path)}
#load data
data <- read.csv("hip.csv", sep=',')
#Export
#write.csv(data,"hip.csv", row.names = FALSE)
#Display the names of variables in the data set.
names(data)
#transform/include labels to data
data = data %>%
mutate(sex = factor(sex, levels = c(0,1), labels = c("Male","Female")),
retired = factor(retired, levels = c(0,1), labels = c("Not retired","Retired")),
ethnic = factor(ethnic, levels = c(0,1), labels = c("White","Non white")),
side = factor(side, levels = c(0,1), labels = c("Right","Left")),
smoking = factor(smoking, levels = c(0,1), labels = c("Non-smoker","Smoker")),
occupation = factor(data$occupation, levels = c(0,1), labels = c("Non-manual worker","Manual worker")) )
#Observe/explore the data
dim(data)
summary(data)
#install.packages("dplyr")
library(dplyr)
#See your working directory
getwd()
#Update your working directory to the folder where "hip.data" is stored (if necessary)
update_wd = "NO" #"NO" for keeping the current working directory. "YES" to update, plus including the new path in folder_path variable below.
if(update_wd == "YES"){
folder_path <- ("C:/Users/msanchez/Documents/GitHub/Practical_Imputation/multiple-imputation_with_mice/")  #Remind to use / (NOT \)
setwd(folder_path)}
#load data
data <- read.csv("hip.csv", sep=',')
#Export
#write.csv(data,"hip.csv", row.names = FALSE)
#Display the names of variables in the data set.
names(data)
#transform/include labels to data
data = data %>%
mutate(sex = factor(sex, levels = c(0,1), labels = c("Male","Female")),
retired = factor(retired, levels = c(0,1), labels = c("Not retired","Retired")),
ethnic = factor(ethnic, levels = c(0,1), labels = c("White","Non white")),
side = factor(side, levels = c(0,1), labels = c("Right","Left")),
smoking = factor(smoking, levels = c(0,1), labels = c("Non-smoker","Smoker")),
occupation = factor(data$occupation, levels = c(0,1), labels = c("Non-manual worker","Manual worker")) )
#Observe/explore the data
dim(data)
summary(data)
#list the variables you want to test
test_var_list = c("eq5d0", "height", "weight", "bmi", "satisfaction", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(test_var_list)){
test_var = ifelse(is.na(data[[test_var_list[v]]]), 1,0 )
test = glm(test_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", test_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
#list the variables you want to test
test_var_list = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(test_var_list)){
test_var = ifelse(is.na(data[[test_var_list[v]]]), 1,0 )
test = glm(test_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", test_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
glm(bmi ~ sex, data=data)
#list the variables you want to test
test_var_list = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(test_var_list)){
test_var = ifelse(is.na(data[[test_var_list[v]]]), 1,0 )
test = glm(test_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", test_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
test = glm(bmi ~ sex, data=data)
print(summary(test))
test = glm(bmi ~ sex, data=data)
print(summary(test))
library(misty)
na.test(data)
library(misty)
na.test(data[-c("id")])
library(misty)
na.test(data[,-c("id")])
library(misty)
na.test(data[data,select = -c("id")])
library(misty)
na.test(data[data,select = -c(1)])
library(misty)
na.test(data[,select = -c(1)])
data[,select = -c("id")]
data[,-c("id")]
data[data,-c("id")]
data[,!c("id")]
data[,!"id"]
data[,c("id"):=NULL]
within(data, rm(id))
library(misty)
na.test(within(data, rm(id)))
#list the variables you want to test
miss_var = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(miss_var)){
miss_var = ifelse(is.na(data[[miss_var[v]]]),1,0 )
test = glm(miss_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", miss_var[v], sep=""))
print(summary(test))   #Check p_value
}
miss_var = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
View(data)
#list the variables you want to test
miss_var = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(miss_var)){
miss_var = ifelse(is.na(data[[miss_var[v]]]), 1, 0)
test = glm(miss_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", miss_var[v], sep=""))
print(summary(test))   #Check p_value
}
test_var_list = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(test_var_list)){
miss_var = ifelse(is.na(data[[test_var_list[v]]]), 1,0 )
test = glm(test_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", test_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
for (v in 1:length(test_var_list)){
test_var = ifelse(is.na(data[[test_var_list[v]]]), 1,0 )
test = glm(test_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", test_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
miss_var_list = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(miss_var_list)){
miss_var = ifelse(is.na(data[[miss_var_list[v]]]), 1, 0)
test = glm(miss_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", miss_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
library(misty)
#We are excluding 'id' from the dataset.
na.test(within(data, rm(id)))
#list the variables you want to test
miss_var_list = c("eq5d0", "bmi", "ethnic", "imdscore","smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
for (v in 1:length(miss_var_list)){
miss_var = ifelse(is.na(data[[miss_var_list[v]]]), 1, 0)
test = glm(miss_var ~ ., data=data[complete_var] )
print(paste("Tested variable: ", miss_var_list[v], sep=""))
print(summary(test))   #Check p_value
}
library(misty)
#We are excluding 'id' from the dataset.
na.test(within(data, rm(id)))
corr_var = c("miss_eq5d0", "miss_ethnic", "miss_imdscore", "miss_bmi", "miss_smoking", complete_var)
names(miss_data[corr_var])
miss_var_list = c("eq5d0", "ethnic", "imdscore", "bmi", "smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
library(ggcorrplot)
install.packages("ggcorrplot")
miss_var_list = c("eq5d0", "ethnic", "imdscore", "bmi", "smoking")
complete_var  = c("age", "sex", "retired", "ohsdiff","side","occupation")
library(ggcorrplot)
#Generate a data frame where missing variables are codified by 0=non-missing value and 1=missing value:
miss_data =  data %>% mutate(
miss_eq5d0= ifelse(is.na(eq5d0),1,0),
miss_ethnic= ifelse(is.na(ethnic),1,0),
miss_imdscore= ifelse(is.na(imdscore),1,0),
miss_bmi=ifelse(is.na(bmi),1,0),
miss_smoking= ifelse(is.na(smoking),1,0) )
corr_var = c("miss_eq5d0", "miss_ethnic", "miss_imdscore", "miss_bmi", "miss_smoking", complete_var)
model.matrix(~0+., data=miss_data[corr_var]) %>%
cor(use="pairwise.complete.obs")  %>%
ggcorrplot(show.diag = F, type="lower", lab=TRUE, lab_size=2)
#list the variables you want to test
miss_var_list = c("eq5d0", "ethnic", "imdscore", "bmi", "smoking")
complete_var  = c("age", "sex", "ohsdiff","ohs0")
library(ggcorrplot)
#Generate a data frame where missing variables are codified by 0=non-missing value and 1=missing value:
miss_data =  data %>% mutate(
miss_eq5d0= ifelse(is.na(eq5d0),1,0),
miss_ethnic= ifelse(is.na(ethnic),1,0),
miss_imdscore= ifelse(is.na(imdscore),1,0),
miss_bmi=ifelse(is.na(bmi),1,0),
miss_smoking= ifelse(is.na(smoking),1,0) )
corr_var = c("miss_eq5d0", "miss_ethnic", "miss_imdscore", "miss_bmi", "miss_smoking", complete_var)
model.matrix(~0+., data=miss_data[corr_var]) %>%
cor(use="pairwise.complete.obs")  %>%
ggcorrplot(show.diag = F, type="lower", lab=TRUE, lab_size=2)
#Selecting variables with missing data
miss_vars <- c( "eq5d0", "ethnic","imdscore", "bmi", "smoking")
#Exploring missing pattern with md.pattern() function
#The md.pattern() function shipped with Multivariate Imputation by Chained Equations (MICE) package can be used to produce a table displaying the missing pattern.
#install.package("mice")
library(mice)
md.pattern(data[miss_vars], plot=FALSE)
#Visual presentation of missing data pattern
#We are using three different functions to display visually the patterns of the missing data in R:
#library(mice)
md.pattern(data[miss_vars], plot=TRUE, rotate.names=TRUE)
#install.package("ggmice")
library(ggmice)
plot_pattern(data[miss_vars], vrb = "all", square = FALSE, rotate = TRUE, cluster = NULL)
#install.packages("VIM")
library(VIM)
aggr(data[miss_vars], labels=names(data), numbers=FALSE, prop=TRUE)
#Visual presentation of missing data pattern
#We are using three different functions to display visually the patterns of the missing data in R:
#library(mice)
md.pattern(data[miss_vars], plot=TRUE, rotate.names=TRUE)
#install.package("ggmice")
library(ggmice)
plot_pattern(data[miss_vars], vrb = "all", square = FALSE, rotate = FALS, cluster = NULL)
#Visual presentation of missing data pattern
#We are using three different functions to display visually the patterns of the missing data in R:
#library(mice)
md.pattern(data[miss_vars], plot=TRUE, rotate.names=TRUE)
#install.package("ggmice")
library(ggmice)
plot_pattern(data[miss_vars], vrb = "all", square = FALSE, rotate = FALSE, cluster = NULL)
#install.packages("VIM")
library(VIM)
aggr(data[miss_vars], labels=names(data), numbers=FALSE, prop=TRUE)
#list the variables you want to test
continuous_var = c("age", "eq5d0", "bmi", "imdscore" )
outcome = "ohsdiff"
for (v in 1:length(continuous_var)){
df = cbind(data[continuous_var[v]],outcome = data[[outcome]])
linear_test = lm(outcome ~ ., data = df)
par(mfrow = c(2, 2))
plot(linear_test,main=paste(continuous_var[v],"\n",sep=""))
}
library(ggcorrplot)
#list the variables you want to test
miss_var_list = c("eq5d0", "ethnic", "imdscore", "bmi", "smoking")
auxiliar_var  = c("retired", "satisfaction", "side", "occupation")
#Generate a data frame where missing variables are codified by 0=non-missing value and 1=missing value:
miss_data =  data %>% mutate(
miss_eq5d0= ifelse(is.na(eq5d0),1,0),
miss_ethnic= ifelse(is.na(ethnic),1,0),
miss_imdscore= ifelse(is.na(imdscore),1,0),
miss_bmi=ifelse(is.na(bmi),1,0),
miss_smoking= ifelse(is.na(smoking),1,0) )
corr_var = c("miss_eq5d0", "miss_ethnic", "miss_imdscore", "miss_bmi", "miss_smoking", auxiliar_var)
model.matrix(~0+., data=miss_data[corr_var]) %>%
cor(use="pairwise.complete.obs")  %>%
ggcorrplot(show.diag = F, type="lower", lab=TRUE, lab_size=2)
##1st.) Check outcome distribution:
#By ploting the histogram we can see if the outcome distribution is skewed or not.
hist(data$ohsdiff)
#If age has a normal distribution, use de mean, otherwise use the median (ie. fun = mean OR fun = median)
##2nd.A) Spliting bmi in 2 categories:
bmi_2 = ifelse(data$bmi >= 25, "25+", "<25")
#interaction.plot using median of AGE
interaction.plot(x.factor=bmi_2, trace.factor=data$sex, response=data$ohsdiff, fun = median,  col = c("#0198f9", "#f95801"))
#interaction.plot using mean of AGE
interaction.plot(x.factor=bmi_2, trace.factor=data$sex, response=data$ohsdiff, fun = mean,  col = c("#0198f9", "#f95801"))
##2nd.B) Spliting bmi in >2 categories:
bmi_cat=with(data, cut(bmi, breaks = c(0,18.5,25,30,70), labels = c('underweight','normal', 'overweight', 'obese'),right=FALSE))
#table(bmi_cat,data$sex)
bmi_cat=with(data, cut(bmi, breaks = c(0,25,30,70), labels = c('<25', 'overweight', 'obese'),right=FALSE))
#interaction.plot using median of AGE
interaction.plot(x.factor=bmi_cat, trace.factor=data$sex, response=data$ohsdiff, fun = median,  col = c("#0198f9", "#f95801"))
#interaction.plot using mean of AGE
interaction.plot(x.factor=bmi_cat, trace.factor=data$sex, response=data$ohsdiff, fun = mean,  col = c("#0198f9", "#f95801"))
#Visual presentation of missing data pattern
#We are using three different functions to display visually the patterns of the missing data in R:
#library(mice)
md.pattern(data[miss_vars], plot=TRUE, rotate.names=TRUE)
#install.package("ggmice")
library(ggmice)
plot_pattern(data[miss_vars], vrb = "all", square = FALSE, rotate = FALSE, cluster = NULL)
#install.packages("VIM")
library(VIM)
aggr(data[miss_vars], labels=names(data), numbers=FALSE, prop=TRUE)
aggr(data[miss_vars], labels=names(miss_data), numbers=FALSE, prop=TRUE)
aggr(data[miss_vars], numbers=FALSE, prop=TRUE)
names(data) #3.1
names(data) #3.1
impmodel_var=c("age","sex","ohs0","ohsdiff","ethnic","eq5d0","bmi","imdscore","smoking")#3.2
names(data) #3.1
impmodel_var=c("age","sex","ohs0","ohsdiff","ethnic","eq5d0","bmi","imdscore","smoking")#3.2
# Specify a separate imputation model for variables of interest
# Numeric variables
num <- c("eq5d0","bmi", "imdscore")
# Dichotomous variable
log <- c("ethnic", "smoking")
# Turn their methods matrix into the specified imputation models
meth[num] <- "pmm"
mice(data[impmodel_var], m=5, maxit=0)
imp <- mice(data[impmodel_var], m=5, maxit=0)
imp$method
imp2 <- mice(data[impmodel_var], maxit = 5, method = meth)
meth[norm] <- "norm.nob"
method
imp$method
method[norm] <- "norm.nob"
meth <- imp$method
# Numeric variables - non-normal distribution
norm <- c("bmi")
# Numeric variables - non-normal distribution
nonnorm <- c("eq5d0", "imdscore")
# Dichotomous variable
log <- c("ethnic", "smoking")
# Turn their methods matrix into the specified imputation models
meth[norm] <- "norm.nob"
meth[nonnorm] <- "pmm"
meth[log] <- "logreg"
imp2 <- mice(data[impmodel_var], maxit = 5, method = meth)
imp2$method
imp2 <- mice(data[impmodel_var], maxit = 5, method = meth)
names(data) #3.1
impmodel_var=c("age","sex","ohs0","ohsdiff","ethnic","eq5d0","bmi","imdscore","smoking")#3.2
# We run the mice code with 0 iterations
imp <- mice(data[impmodel_var], m=5, maxit=0)
imp$method #3.2
#In this example, mice identifies the correct distribution for each variable. But, if for example, if you want to change the method used for bmi, you can do the following:
meth <- imp$method
# Numeric variables - normal distribution (we are using "Linear regression, non-Bayesian" method to impute bmi)
norm <- c("bmi")
# Numeric variables - non-normal distribution
nonnorm <- c("eq5d0", "imdscore")
# Dichotomous variable
log <- c("ethnic", "smoking")
# Turn their methods matrix into the specified imputation models
meth[norm] <- "norm.nob"
meth[nonnorm] <- "pmm"
meth[log] <- "logreg"
imp2 <- mice(data[impmodel_var], maxit = 5, method = meth)
imp2$method
imp = mice(data, maxit=10, m = 5)  #7.1
impmodel_var=c("age","sex","ohs0","ohsdiff","ethnic","eq5d0","bmi","imdscore","smoking")#3.2
imp = mice(data[impmodel_var], maxit=10, m = 5)  #7.1
fit = with(data=imp,expr = lm(ohsdiff~age+sex+bmi+eq5d0+ethnic+imdscore+smoking+ohs0)) #7.2
summary(pool(fit), conf.int = TRUE) #7.3
library(finalfit)
install.packages("finalfit")
library(finalfit)
library(dplyr)
library(MissMech)
install.packages("MissMech")
library(finalfit)
library(dplyr)
library(MissMech)
## Try test interaction with other independent variable.
##Categorise varX if needed:
varX_cat = data$ethnic
#interaction.plot using median of ohsdiff (outcome):
interaction.plot(x.factor=varX_cat, trace.factor=data$sex, response=data$ohsdiff, fun = median,  col = c("#0198f9", "#f95801"))
#interaction.plot using mean of ohsdiff (outcome):
interaction.plot(x.factor=varX_cat, trace.factor=data$sex, response=data$ohsdiff, fun = mean,  col = c("#0198f9", "#f95801"))
#List of the variables you want to test (numeric variables)
num_var = c("age", "eq5d0", "bmi", "imdscore" )
outcome = "ohsdiff"
for (v in 1:length(num_var)){
df = cbind(data[num_var[v]],outcome = data[[outcome]])
linear_test = lm(outcome ~ ., data = df)
par(mfrow = c(2, 2))
plot(linear_test,main=paste(num_var[v],"\n",sep=""))
}
#List of the variables you want to test (numeric variables)
num_var = c("age", "eq5d0", "bmi", "imdscore" )
outcome = "ohsdiff"
for (v in 1:length(num_var)){
df = cbind(data[num_var[v]],outcome = data[[outcome]])
linear_test = lm(outcome ~ ., data = df)
par(mfrow = c(2, 2))
plot(linear_test,main=paste(num_var[v],"\n",sep=""))
}
